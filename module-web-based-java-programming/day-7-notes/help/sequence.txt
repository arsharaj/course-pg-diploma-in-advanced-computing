Today's topics

Revise JSP Basics
HttpSession + URL Rewriting
JSP Directives
JSP Actions
JSP-JavaBean


Revision :

1. Name JSP Scripting elements
scriptlet , expression(EL syntax) , declaration

2. Name JSP impl objects available from scriptlets n expression
request,response, out,config,session,application,exception,page,pageContext

3. Name EL impl objects available from EL syntax(${...})
param,pageScope,requestScope,sessionScope,applicationScope,cookie,initParam ......


eg : How will you get the value of a cookie by the name "abc"?
EL syntax
${cookie.abc.value}
WC : cookie.get("abc").getValue() --> sent to clnt browser

4. Solve : 

${pageContext.session.maxInactiveInterval}
Equivalent java code , called by WC : pageContext.getSession().getMaxInactiveInterval() --> sent to clnt

Suppose : user_info : session scoped attribute
${sessionScope.user_info}
WC : sessionScope.get("user_info") --> to string --> sent to clnt
OR
session.getAttribute("user_info")  --> to string --> sent to clnt

${pageContext.session.id}
WC : pageContext.getSession().getId() --> sent to clnt

${param.email}
WC : request.getParameter("email") --- sent to clnt


How to invalidate session ?
1. Scriptlet : 
<%
 session.invalidate();
%>

OR 
2. JSP expr : <%= session.invalidate() %> : compiler err

OR

3. EL syntax : ${pageContext.session.invalidate()}

WC : pageContext.getSession().invalidate() : works !

IDE : shows error , IGNORE IDE , it actually works !!!!


------------------------------------Revision Over ----------------------

5. Identify JSP Directives n  important attributes
page
include
taglib


1.  (Are there any problems observed in client pull , in basic JSP assignment , if cookies are disabled?) : 


Any solution ? 


Any problems in URL rewriting technique : YES


Vulnerable (open to security attack) :

Security attack : Session Fixation or man in middle / session stealing

Soln : Do not use URL rewriting approach n force the clients to accept the cookies (Cookies also can be stored in a secure manner , Cookie class API : public void setSecure(boolean flag))
OR use https : for end to end encryption


2. JSP Actions : request dispatcher related

Objective : User login 
We have already solved it using servlets . Right ?
So why JSP  Using Java Beans
For separation of concerns(=tasks/responsibilities)
We are going to separate :
1.  P.L (presentation logic) , navigation in a JSP 
(w/o using java code)

2. B.L (Business logic) : separated in a java class : java bean 


Enter 
1. What is a java bean ?
2. Why Java Beans ?


case study : Voting case study  (admin role)


Layers to be copied from earlier (servlet based) assgnment
No change in : Tables, POJOs, DAOs , DBUtils
 
Steps
1. UserBean : for authentication of user
1.1 public pkged class : UserBean
1.2 props : email, password + 
UserDao , User : POJO
1.3 def ctor : create dao instance
1.4 getters n setters
1.5 B.L method 
Add B.L method to ret : routing info : String
failed login : login.jsp
voter , not yet voted : candidate_list.jsp
voter ,  voted : logout.jsp
admin login -- admin_main.jsp
Before calling B.L method , what will JSP call ?
<jsp:useBean> , <jsp:setProperty>
eg : public String validateUser()
{
  invoke dao's method -- null --> login
    store user details ---> user pojo
   as per role --rets the page name
}



3. JSP standard Actions Using java beans 
3.1
<jsp:useBean id="bean id" class="Fully qualified bean class" scope="page|request|session|application"/>
Mandatory attributes : id n class
Def value of scope=page

eg: 

Internals (What will WC invoke?)
refer to a digram

2. Data binding  from view layer ---> model (java bean)
i.e calling the setters of Javabean properties.
<jsp:setProperty name="bean id" property="*"/>
eg : 

WC tries to invoke ALL MATCHING setters , on java bean instance
(i.e for complete data xfer : MATCH req param names with JB property setters)

3. Invoke B.L method using EL syntax
eg : ${sessionScope.user.validateUser()}
WC : 

4. Navigate clnt to the next page in the SAME request(server pull : forward)
eg : <jsp:forward page="${sessionScope.user.validateUser()}.jsp"/>


5. How to invoke getters of JB ?
5.1 <jsp:getProperty name="voter" property="validatedUser"/>


OR 
EL syntax : 

WC : 


